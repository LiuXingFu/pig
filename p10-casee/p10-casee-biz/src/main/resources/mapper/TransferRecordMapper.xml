<?xml version="1.0" encoding="UTF-8"?>

<!--
  ~
  ~      Copyright (c) 2018-2025, lengleng All rights reserved.
  ~
  ~  Redistribution and use in source and binary forms, with or without
  ~  modification, are permitted provided that the following conditions are met:
  ~
  ~ Redistributions of source code must retain the above copyright notice,
  ~  this list of conditions and the following disclaimer.
  ~  Redistributions in binary form must reproduce the above copyright
  ~  notice, this list of conditions and the following disclaimer in the
  ~  documentation and/or other materials provided with the distribution.
  ~  Neither the name of the pig4cloud.com developer nor the names of its
  ~  contributors may be used to endorse or promote products derived from
  ~  this software without specific prior written permission.
  ~  Author: lengleng (wangiegie@gmail.com)
  ~
  -->

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.pig4cloud.pig.casee.mapper.TransferRecordMapper">

  <resultMap id="transferRecordMap" type="com.pig4cloud.pig.casee.entity.TransferRecord">
    <id property="transferRecordId" column="transfer_record_id"/>
    <result property="bankLoanId" column="bank_loan_id"/>
    <result property="entrustedInsId" column="entrusted_ins_id"/>
    <result property="entrustedOutlesId" column="entrusted_outles_id"/>
    <result property="litigation" column="litigation"/>
    <result property="handoverAmount" column="handover_amount"/>
    <result property="handoverTime" column="handover_time"/>
    <result property="startingTime" column="starting_time"/>
    <result property="returnTime" column="return_time"/>
    <result property="status" column="status"/>
    <result property="remark" column="remark"/>
  </resultMap>

	<select id="getBankLoanIdTransferRecord" resultType="com.pig4cloud.pig.casee.vo.TransferRecordVO">
		select
		*,
		p10_institution.ins_name as entrustedInsName,
		p10_outles.outles_name as entrustedOutlesName
		from p10_transfer_record
		left join p10_institution on p10_institution.ins_id=p10_transfer_record.entrusted_ins_id
		left join p10_outles on p10_outles.outles_id=p10_transfer_record.entrusted_outles_id
		where
		p10_transfer_record.del_flag=0 and p10_transfer_record.bank_loan_id=#{bankLoanId}
	</select>

	<select id="getTransferRecordBankLoan" resultType="com.pig4cloud.pig.casee.vo.TransferRecordBankLoanVO">
		SELECT
			*,
			entrustedInstitution.ins_name AS entrustedInsName,
			entrustedOutles.outles_name AS entrustedOutlesName,
			institution.ins_name AS insName,
			outles.outles_name AS outlesName
		FROM
			p10_transfer_record
			LEFT JOIN p10_institution AS entrustedInstitution ON entrustedInstitution.ins_id = p10_transfer_record.entrusted_ins_id
			LEFT JOIN p10_outles AS entrustedOutles ON entrustedOutles.outles_id = p10_transfer_record.entrusted_outles_id
			LEFT JOIN p10_bank_loan ON p10_bank_loan.bank_loan_id = p10_transfer_record.bank_loan_id
			LEFT JOIN p10_institution AS institution ON institution.ins_id = p10_bank_loan.ins_id
			LEFT JOIN p10_outles AS outles ON outles.outles_id = p10_bank_loan.outles_id
		WHERE
			p10_transfer_record.del_flag = 0
	 		and p10_transfer_record.transfer_record_id=#{transferRecordId}
	</select>

</mapper>
